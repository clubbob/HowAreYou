# 지금 어때? (HowAreYou) - 상세 PRD (최신 버전)

**작성일**: 2026년 2월 6일  
**최종 수정일**: 2026년 2월 6일 (GPT 검증 반영)  
**버전**: 2.1  
**프로젝트 ID**: howareyou-1c5de

---

## 📋 목차

1. [프로젝트 개요](#1-프로젝트-개요)
2. [핵심 원칙](#2-핵심-원칙)
3. [타겟 사용자](#3-타겟-사용자)
4. [기술 스택](#4-기술-스택)
5. [주요 기능](#5-주요-기능)
6. [데이터 모델](#6-데이터-모델)
7. [화면 구조](#7-화면-구조)
8. [초대 링크 시스템](#8-초대-링크-시스템)
9. [알림 시스템](#9-알림-시스템)
10. [보안 규칙](#10-보안-규칙)
11. [비용 구조](#11-비용-구조)
12. [배포 상태](#12-배포-상태)

---

## 1. 프로젝트 개요

### 1.1 서비스명
**지금 어때? (How Are You?)**

### 1.2 목적
독거노인 등 혼자 지내는 사용자가 부담 없이 하루 1회 간단히 컨디션을 기록할 수 있는 안부 기록 앱입니다. 보호자(부모, 자녀, 배우자 등)는 연결된 경우에만 최근 7일 기록을 확인할 수 있습니다.

### 1.3 핵심 가치
- **감시하지 않는다**: 보호자가 보호대상자의 상세한 위치나 활동을 추적하지 않음
- **판단하지 않는다**: 상태 응답에 대한 평가나 판단을 하지 않음
- **선택적 공유**: 보호대상자가 원할 때만 상태를 공유하고, 보호자는 직접 앱에서 확인

---

## 2. 핵심 원칙

### 2.1 프라이버시
- 보호대상자의 상태 응답 내용은 시스템에만 저장됨
- 보호자는 보호대상자가 직접 연결을 허용한 경우에만 최근 7일 상태를 확인 가능
- 보호자는 응답 내용을 볼 수 있지만, 정확한 응답 시각은 공유되지 않음 (날짜 기준만)

### 2.2 사용자 경험
- 최소한의 입력으로 빠른 상태 확인
- 직관적인 UI/UX
- 앱 설치 여부와 관계없이 초대 링크로 연결 가능

---

## 3. 타겟 사용자

### 3.1 보호대상자 (Subject)
- 독거노인, 혼자 지내는 사용자
- 하루 1회 간단히 컨디션을 기록하고 싶은 사용자
- 스마트폰 사용이 가능한 사용자
- **핵심 인식**: 보호자에게 알려주는 행위가 아닌, 본인을 위한 기록 행위

### 3.2 보호자 (Guardian)
- 부모, 자녀, 배우자 등 연락 담당자
- 보호대상자의 안부를 확인하고 싶은 사용자
- 여러 보호대상자를 관리할 수 있음

### 3.3 역할 중복
- 한 사용자가 보호대상자이면서 동시에 보호자 역할도 수행 가능
- 앱 내에서 역할 모드를 전환하여 사용

---

## 4. 기술 스택

### 4.1 프론트엔드
- **Flutter**: 크로스 플랫폼 앱 개발 (Android/iOS)
- **상태 관리**: Provider 패턴
- **UI 라이브러리**: Material Design 3
- **주요 패키지**:
  - `firebase_core`: ^3.6.0
  - `firebase_auth`: ^5.3.1 (전화번호 OTP 인증)
  - `cloud_firestore`: ^5.4.4 (NoSQL 데이터베이스)
  - `firebase_messaging`: ^15.1.3 (FCM 푸시 알림)
  - `flutter_local_notifications`: ^18.0.1 (로컬 알림)
  - `provider`: ^6.1.2 (상태 관리)
  - `intl`: ^0.19.0 (국제화)
  - `timezone`: ^0.9.4 (타임존 처리)
  - `shared_preferences`: ^2.2.2 (로컬 저장소)
  - `fl_chart`: ^0.69.0 (차트 표시)
  - `app_links`: ^6.3.2 (딥링크 처리)
  - `share_plus`: ^10.1.2 (링크 공유)

### 4.2 백엔드 & 인프라
- **Firebase Authentication**: 전화번호 OTP 인증
- **Cloud Firestore**: NoSQL 데이터베이스
- **Firebase Cloud Messaging (FCM)**: 푸시 알림
- **Firebase Cloud Functions**: 서버리스 백엔드 로직 (Node.js 20)
- **Firebase Hosting**: 웹 초대 페이지 호스팅
- **Play Install Referrer API**: 앱 설치 추적 (Android)

### 4.3 네이티브 코드
- **Android**: Kotlin (MainActivity.kt)
  - Install Referrer API 연동
  - MethodChannel을 통한 Flutter 연동
- **iOS**: Swift (향후 지원 예정)

---

## 5. 주요 기능

### 5.1 역할 선택 시스템

#### 5.1.1 역할 모드
- **보호대상자 모드**: 상태를 알려주는 역할
- **보호자 모드**: 보호대상자의 상태를 확인하는 역할
- 한 사용자가 두 역할 모두 수행 가능

#### 5.1.2 모드 전환
- 앱 실행 시 역할 선택 화면 표시
- 마지막 선택 모드 자동 저장 및 복원
- 언제든지 역할 모드 전환 가능

### 5.2 보호대상자 기능

#### 5.2.1 컨디션 기록
- **기능명**: "오늘 컨디션 기록하기" (기존 "상태 알려주기"에서 변경)
- **질문**: "지금 어때?"
- **응답 옵션**: 3가지 기분 선택
  - 🙂 괜찮아 (초록색)
  - 😐 보통 (베이지색)
  - 🙁 별로 (주황색)
- **응답 규칙**: 하루 1회 (24시 기준)
- **응답 완료**: 아이콘 선택 시 즉시 저장 및 완료
- **완료 메시지**: "오늘 상태를 남겼어요." 또는 "기록되었습니다." (기존 "고마워요."에서 변경)
- **의도**: 보고·의무·감시 뉘앙스 제거, 본인을 위한 기록 행위로 인식 전환

#### 5.2.2 보호자 지정
- 전화번호로 보호자 검색 및 추가
- 보호자 이름 커스터마이징 가능
- 여러 보호자 지정 가능
- 보호자 제거 기능

#### 5.2.3 보호자 초대 (링크 방식)
- 초대 링크 생성 및 공유
- 보호자가 앱이 설치되어 있지 않아도 Play Store에서 설치 후 자동 연결
- 보호자가 이미 앱이 설치되어 있어도 링크 클릭 시 자동 연결

#### 5.2.4 최근 컨디션 확인
- **화면 제목**: "최근 컨디션" (기존 "내 상태 보기"에서 변경)
- 오늘의 상태 확인
- 최근 7일 추이 차트 (fl_chart 사용)
- 최근 7일 이력 테이블
- 상태 아이콘 및 라벨 표시
- **요약 문장**: 차트 상단에 최근 7일 데이터 기반 요약 표시
  - 예: "최근 7일 중 5일은 '괜찮아' 상태였습니다."
  - 예: "최근 일주일은 비슷한 컨디션이 이어지고 있어요."
  - **주의**: 판단·평가 표현 금지, 단순 기록 해석만 제공

### 5.3 보호자 기능

#### 5.3.1 보호 대상 관리
- 보호 대상자 목록 표시
- 각 보호 대상자의 오늘 상태 확인
- 보호 대상자 이름 및 상태 아이콘 표시
- 보호 대상자 추가/제거

#### 5.3.2 보호 대상 상세 확인
- 최근 7일 추이 차트
- 최근 7일 이력 테이블
- 상태 아이콘 및 라벨 표시
- 최근 응답 시간 표시

#### 5.3.3 보호 대상자 초대 (링크 방식)
- 초대 링크 생성 및 공유
- 보호대상자가 앱이 설치되어 있지 않아도 Play Store에서 설치 후 자동 연결
- 보호대상자가 이미 앱이 설치되어 있어도 링크 클릭 시 자동 연결

#### 5.3.4 알림 수신
- **응답 알림**: 보호 대상자가 상태를 등록했을 때
  - 알림 내용: "OO님이 오늘 상태를 알려주었습니다"
  - 소리 ON (Android 채널: `guardian_notifications`)
  - 알림 탭 시 보호 대상 관리 화면으로 이동

#### 5.3.5 알림 보내기
- 보호 대상자에게 "기분 알려주기" 유도 알림 전송
- FCM을 통한 푸시 알림 발송

### 5.4 인증 시스템

#### 5.4.1 전화번호 OTP 인증
- Firebase Auth를 통한 전화번호 인증
- SMS OTP 코드 입력
- 자동 로그인 유지

#### 5.4.2 사용자 식별
- 사용자 UID = Firebase Auth UID
- `users/{uid}` 문서 ID = Auth UID
- `subjects/{subjectUid}` 문서 ID = 보호대상자 Auth UID

---

## 6. 데이터 모델

### 6.1 Firestore 컬렉션 구조

#### 6.1.1 `/users/{uid}`
사용자 기본 정보

```typescript
{
  uid: string;              // 문서 ID = Firebase Auth UID
  role?: 'guardian' | 'subject' | 'both';
  phone?: string;           // 전화번호
  fcmTokens?: string[];     // FCM 토큰 배열 (여러 기기 지원)
  displayName?: string;     // 표시 이름
}
```

#### 6.1.2 `/subjects/{subjectUid}`
보호대상자 정보

```typescript
{
  subjectUid: string;                    // 문서 ID = 보호대상자 Auth UID
  displayName?: string;                  // 보호대상자 이름
  phone?: string;                        // 전화번호
  pairedGuardianUids: string[];         // 연결된 보호자 UID 배열
  guardianInfos: {                       // 보호자 상세 정보
    [guardianUid: string]: {
      phone: string;
      displayName: string;
    }
  }
}
```

#### 6.1.3 `/subjects/{subjectUid}/prompts/{dateSlot}`
상태 응답 문서

```typescript
{
  slot: 'daily';                         // 시간대 (하루 1회 모드)
  answeredAt: Timestamp;                 // 응답 시각
  mood: 1 | 2 | 3 | 4 | 5;              // 기분 값
  note?: string;                         // 메모 (선택)
}
```

**문서 ID 형식**: `YYYY-MM-DD` (예: `2026-02-06`)

#### 6.1.4 Mood 값 매핑
```typescript
1: Mood.good      // 좋아 (😊)
2: Mood.okay      // 괜찮아 (🙂)
3: Mood.normal    // 보통 (😐)
4: Mood.notGood   // 별로 (🙁)
5: Mood.hard      // 힘들어 (😞)
```

**선택 가능한 옵션**: 2 (괜찮아), 3 (보통), 4 (별로)만 선택 가능

### 6.2 데이터 접근 규칙

#### 6.2.1 보호대상자
- 자신의 `subjects/{subjectUid}` 문서: 읽기/쓰기 가능
- 자신의 `prompts` 서브컬렉션: 읽기/쓰기 가능
- 모든 이력 조회 가능

#### 6.2.2 보호자
- 연결된 보호대상자의 `subjects/{subjectUid}` 문서: 읽기만 가능
- 연결된 보호대상자의 `prompts` 서브컬렉션: 읽기만 가능
- 최근 7일까지만 조회 가능
- 정확한 응답 시각은 공유되지 않음 (날짜 기준만)

---

## 7. 화면 구조

### 7.1 화면 목록

#### 7.1.1 SplashScreen (`splash_screen.dart`)
- **역할**: 앱 시작 화면
- **기능**:
  - 인증 상태 확인
  - 초대 링크 처리 (딥링크 또는 Install Referrer)
  - FCM 초기 메시지 처리
  - 자동 라우팅
- **라우팅 로직**:
  - 로그인 상태 + 초대 링크 (보호자): 보호자 모드로 이동
  - 로그인 상태 + 초대 링크 (보호대상자): 보호대상자 모드로 이동
  - 로그인 상태 + FCM 알림: 알림 타입에 따라 화면 이동
  - 로그인 상태: 홈 화면으로 이동
  - 비로그인 상태 + 초대 링크: 초대 환영 화면으로 이동
  - 비로그인 상태: 로그인 화면으로 이동

#### 7.1.2 AuthScreen (`auth_screen.dart`)
- **역할**: 전화번호 OTP 로그인
- **기능**:
  - 전화번호 입력
  - SMS OTP 코드 입력
  - Firebase Auth 인증
  - 초대 링크 처리 후 자동 연결
- **파라미터**:
  - `redirectToSubjectIfInvited`: 보호대상자 초대 링크 처리
  - `redirectToGuardianIfInvited`: 보호자 초대 링크 처리

#### 7.1.3 HomeScreen (`home_screen.dart`)
- **역할**: 역할 선택 화면
- **기능**:
  - "보호대상자 모드" / "보호자 모드" 버튼
  - 마지막 선택 모드 자동 복원
- **제목**: "지금 어때?"

#### 7.1.4 SubjectModeScreen (`subject_mode_screen.dart`)
- **역할**: 보호대상자 메인 화면
- **기능**:
  - "오늘 컨디션 기록하기" 버튼 (기존 "상태 알려주기"에서 변경)
  - "보호자 지정" 버튼
  - "최근 컨디션" 버튼 (기존 "내 상태 보기"에서 변경)
  - **설명 문구**: 주요 버튼 하단 또는 상단에 1줄 고정
    - 예: "전화 대신 오늘 컨디션을 간단히 남길 수 있어요."
    - 예: "하루 한 번, 상태를 기록해 두세요."
- **제목**: "보호대상자 모드"
- **최초 진입 시 안내**: 보호대상자 모드 최초 진입 시 안내 문구 표시 (다이얼로그 또는 상단 안내)

#### 7.1.5 QuestionScreen (`question_screen.dart`)
- **역할**: 컨디션 기록 화면
- **기능**:
  - 질문: "지금 어때?"
  - 3가지 기분 선택 (괜찮아, 보통, 별로)
  - 응답 저장 및 완료 처리
  - "오늘 상태를 남겼어요." 또는 "기록되었습니다." 메시지 표시 (기존 "고마워요."에서 변경)
- **제목**: "오늘 컨디션 기록하기" (기존 "상태 알려주기"에서 변경)
- **주의**: 종결·안심을 암시하는 표현 사용 금지 ("여기까지", "충분", "안부 종료" 등)

#### 7.1.6 GuardianScreen (`guardian_screen.dart`)
- **역할**: 보호자 추가/관리 화면
- **기능**:
  - 전화번호 검색
  - 보호자 추가
  - 보호자 이름 설정
  - 보호자 제거
  - 링크로 보호자 초대
- **제목**: "보호자 지정"

#### 7.1.7 SubjectMyStatusScreen (`subject_my_status_screen.dart`)
- **역할**: 보호대상자 자신의 컨디션 이력 화면
- **기능**:
  - 오늘 상태 위젯
  - **요약 문장**: 차트 상단에 최근 7일 데이터 기반 요약 표시
    - 예: "최근 7일 중 5일은 '괜찮아' 상태였습니다."
    - 예: "최근 일주일은 비슷한 컨디션이 이어지고 있어요."
    - **주의**: 판단·평가 표현 금지, 단순 기록 해석만 제공
  - 최근 7일 추이 차트 (fl_chart)
  - 최근 7일 이력 테이블
  - 상태 아이콘 및 라벨 표시
- **제목**: "최근 컨디션" (기존 "내 상태 보기"에서 변경)
- **의도**: 관리/진단 느낌 제거, 단순 기록 열람 화면으로 인식 전환

#### 7.1.8 GuardianModeScreen (`guardian_mode_screen.dart`)
- **역할**: 보호자 메인 화면
- **기능**:
  - "보호 대상 관리" 버튼
  - FCM 초기화 (알림 수신을 위해)
- **제목**: "보호자 모드"

#### 7.1.9 GuardianDashboardScreen (`guardian_dashboard_screen.dart`)
- **역할**: 보호 대상자 목록 화면
- **기능**:
  - 보호 대상자 목록 표시
  - 각 보호 대상자의 오늘 상태 확인
  - 보호 대상자 추가 버튼
  - 보호 대상자 상세 화면으로 이동
  - FCM 초기화 (알림 수신을 위해)
- **제목**: "보호 대상 관리"

#### 7.1.10 SubjectDetailScreen (`subject_detail_screen.dart`)
- **역할**: 보호 대상자 상세 화면
- **기능**:
  - 최근 7일 추이 차트
  - 최근 7일 이력 테이블
  - 상태 아이콘 및 라벨 표시
  - 최근 응답 시간 표시
  - 알림 보내기 버튼
- **제목**: 보호 대상자 이름

#### 7.1.11 InvitedSubjectWelcomeScreen (`invited_subject_welcome_screen.dart`)
- **역할**: 보호자 초대 링크로 들어온 사용자 환영 화면
- **기능**:
  - 초대 메시지 표시
  - 로그인 화면으로 이동
- **메시지**: "보호자님이 당신을 보호 대상으로 초대했습니다."

#### 7.1.12 InvitedGuardianWelcomeScreen (`invited_guardian_welcome_screen.dart`)
- **역할**: 보호대상자 초대 링크로 들어온 사용자 환영 화면
- **기능**:
  - 초대 메시지 표시
  - 로그인 화면으로 이동
- **메시지**: "보호대상자님이 당신을 보호자로 초대했습니다."

---

## 8. 초대 링크 시스템

### 8.1 초대 링크 형식

#### 8.1.1 보호자 → 보호대상자 초대
```
https://howareyou-1c5de.web.app/invite?g={guardianUid}
```
- `g`: 보호자 UID (inviterId)

#### 8.1.2 보호대상자 → 보호자 초대
```
https://howareyou-1c5de.web.app/invite?s={subjectUid}
```
- `s`: 보호대상자 UID (subjectId)

### 8.2 초대 링크 처리 흐름

#### 8.2.1 앱이 설치된 경우 (딥링크)
1. 앱이 열림
2. `AppLinks.getInitialLink()`로 URL 파라미터 추출
3. `g` 또는 `s` 파라미터를 `SharedPreferences`에 저장
4. 로그인 상태에 따라 자동 연결 또는 환영 화면 표시

#### 8.2.2 앱이 설치되지 않은 경우 (Play Store)
1. 웹 페이지 (`hosting/invite/index.html`) 표시
2. Play Store 설치 링크로 이동
3. Play Store URL에 `referrer` 파라미터 추가
   - 보호자 초대: `inviterId={guardianUid}`
   - 보호대상자 초대: `subjectId={subjectUid}`
4. 앱 설치 후 첫 실행 시 `Install Referrer API`로 파라미터 추출
5. `SharedPreferences`에 저장 후 자동 연결

### 8.3 초대 링크 공유 메시지

#### 8.3.1 보호자 → 보호대상자
**변경 전 (사용 금지)**:
- 걱정 유발, 감정 호소, 보호자 중심 메시지

**변경 후**:
```
하루 한 번 컨디션만 기록하는 앱이에요.
```
또는
```
간단히 상태를 남길 수 있어요.
```

**의도**: 설치 부담 최소화, "관리 당한다"는 인상 제거

#### 8.3.2 보호대상자 → 보호자
**변경 전**:
```
나의 상태를 알려주는 "지금어때" 앱이야. 링크 누르고 앱 깔면 내 상태를 확인할 수 있어 (이미 깔았어도 됨).
```

**변경 후**:
```
하루 한 번 컨디션만 기록하는 앱이에요. 링크 누르고 앱 깔면 내 기록을 확인할 수 있어요 (이미 깔았어도 됨).
```

**의도**: "알려주는" 표현 대신 "기록" 표현 사용, 보호자 중심 뉘앙스 제거

### 8.4 자동 연결 로직

#### 8.4.1 보호자 → 보호대상자 연결
- `GuardianService.acceptInviteAsSubject()` 호출
- `subjects/{subjectUid}` 문서의 `pairedGuardianUids`에 보호자 UID 추가
- `guardianInfos`에 보호자 정보 추가

#### 8.4.2 보호대상자 → 보호자 연결
- `GuardianService.acceptInviteAsGuardian()` 호출
- `subjects/{subjectUid}` 문서의 `pairedGuardianUids`에 보호자 UID 추가
- `guardianInfos`에 보호자 정보 추가

---

## 9. 알림 시스템

### 9.1 로컬 알림 (보호대상자용)

#### 9.1.1 일일 컨디션 기록 알림
- **발송 시간**: 매일 08:00 (한국 시간)
- **채널 ID**: `daily_mood_check`
- **알림 내용**: "지금 어때? 오늘 컨디션을 기록해 주세요." (기존 "상태를 알려주세요."에서 변경)
- **알림 탭 시**: 질문 화면으로 이동

#### 9.1.2 알림 설정
- 소리 ON (앱 설정에서 무음 가능)
- 알림 권한 요청

### 9.2 FCM 푸시 알림 (보호자용)

#### 9.2.1 응답 알림
- **트리거**: 보호대상자가 컨디션을 기록했을 때
- **발송 방식**: Cloud Functions `onResponseCreated` / `onResponseUpdated`
- **알림 내용**: "OO님이 오늘 컨디션을 기록했습니다" (기존 "오늘 상태를 알려주었습니다"에서 변경)
- **채널 ID**: `guardian_notifications`
- **소리**: ON
- **알림 탭 시**: 보호 대상 관리 화면으로 이동
- **데이터 타입**: `RESPONSE_RECEIVED`

#### 9.2.2 알림 보내기 (보호자 → 보호대상자)
- **트리거**: 보호자가 "알림 보내기" 버튼 클릭
- **발송 방식**: Cloud Functions `sendReminderToSubject` (Callable)
- **알림 내용**: "오늘 컨디션을 기록해 주세요." (기존 "기분 알려주기를 확인해 주세요."에서 변경)
- **알림 탭 시**: 질문 화면으로 이동
- **데이터 타입**: `REMIND_RESPONSE`

### 9.3 FCM 토큰 관리

#### 9.3.1 토큰 등록
- 보호자 모드 진입 시 FCM 초기화
- 보호 대상 관리 화면 진입 시 FCM 초기화
- `users/{uid}` 문서의 `fcmTokens` 배열에 저장
- 여러 기기 지원 (토큰 배열)

#### 9.3.2 토큰 정리
- Invalid 토큰 자동 제거
- Cloud Functions에서 발송 실패 시 토큰 제거

### 9.4 알림 권한 관리

#### 9.4.1 Android
- 런타임 권한 요청
- 커스텀 한글 다이얼로그 표시
- 권한 허용 여부 확인 후 중복 요청 방지

#### 9.4.2 알림 권한 요청 다이얼로그
```
"보호대상자"가 상태를 등록한 경우 "보호자"께 알림을 보내도록 허용하시겠습니까?

다음 화면에서 「허용」을 눌러 주세요.
```

---

## 10. 보안 규칙

### 10.1 Firestore 보안 규칙

#### 10.1.1 `/users/{userId}`
- 본인: 읽기/쓰기 가능
- 다른 사용자: 읽기만 가능 (보호자 검색용)

#### 10.1.2 `/subjects/{subjectUid}`
- 보호대상자 본인: 읽기/쓰기 가능
- 연결된 보호자: 읽기만 가능
- 보호자 추가 시: `pairedGuardianUids` 및 `guardianInfos` 필드만 업데이트 가능

#### 10.1.3 `/subjects/{subjectUid}/prompts/{promptId}`
- 보호대상자 본인: 읽기/쓰기 가능
- 연결된 보호자: 읽기만 가능 (최근 7일)

### 10.2 Cloud Functions 보안

#### 10.2.1 `sendReminderToSubject`
- 인증 필요 (`context.auth`)
- 보호자 권한 확인 (`pairedGuardianUids`에 포함 여부)

---

## 11. 비용 구조

### 11.1 10만 명 기준 월 비용 (미회신 체크 제거 후)

#### 11.1.1 Firestore
- **읽기**: 약 9,000,000회/월 → 약 $0.54/월
- **쓰기**: 약 3,000,000회/월 → 약 $0.18/월
- **합계**: 약 $0.72/월

#### 11.1.2 Cloud Functions
- **응답 알림**: 약 $0.10~$0.20/월
- **알림 보내기**: 무료 (사용량 적음)

#### 11.1.3 FCM
- **무료** (무제한)

#### 11.1.4 총 비용
- **월 약 $1~$1.5** (약 1,300~1,950원)

### 11.2 비용 최적화
- 미회신 체크 기능 제거로 월 약 68만원 → 약 2,000원으로 절감 (99.7% 절감)
- Firestore 읽기 최적화
- Cloud Functions 실행 시간 최소화

---

## 12. 배포 상태

### 12.1 Firebase 프로젝트
- **프로젝트 ID**: howareyou-1c5de
- **호스팅 URL**: https://howareyou-1c5de.web.app
- **초대 링크 베이스**: https://howareyou-1c5de.web.app/invite

### 12.2 Cloud Functions 배포 상태
- ✅ `onResponseCreated`: 응답 생성 시 알림 발송
- ✅ `onResponseUpdated`: 응답 업데이트 시 알림 발송
- ✅ `sendReminderToSubject`: 보호자 → 보호대상자 알림 발송
- ❌ `checkUnreachableSubjects`: 제거됨 (2026년 2월 6일)

### 12.3 호스팅 배포 상태
- ✅ `/invite` 경로: 초대 링크 웹 페이지
- ✅ `rewrites` 규칙: `/invite` → `/invite/index.html`

### 12.4 앱 배포 상태
- **Android**: 개발 중 (Play Store 미배포)
- **iOS**: 미지원 (향후 지원 예정)

---

## 13. 주요 변경 이력

### 13.2 v2.1 (2026년 2월 6일 - GPT 검증 반영)
- ✅ 보호대상자 중심 인식 전환
  - "상태 알려주기" → "오늘 컨디션 기록하기"
  - "내 상태 보기" → "최근 컨디션"
  - "고마워요" → "오늘 상태를 남겼어요." / "기록되었습니다."
- ✅ 보호대상자 홈 화면 설명 문구 추가
- ✅ 이력 화면 요약 문장 추가 (판단·평가 표현 금지)
- ✅ 초대 링크 공유 메시지 개선 (강요·감정 제거)
- ✅ 보호대상자 모드 진입 시 안내 문구 추가
- ✅ 알림 메시지 문구 개선 ("알려주기" → "기록하기")

### 13.1 v2.0 (2026년 2월 6일)
- ✅ 하루 3회 → 하루 1회로 변경
- ✅ 미회신 체크 기능 제거
- ✅ 초대 링크 시스템 추가 (양방향)
- ✅ Play Install Referrer API 연동
- ✅ 보호자 대시보드 개선
- ✅ 알림 권한 관리 개선

### 13.2 v1.0 (초기 버전)
- ✅ 기본 기능 구현
- ✅ 전화번호 OTP 인증
- ✅ 상태 응답 시스템
- ✅ 보호자 연결 시스템

---

## 14. 향후 계획

### 14.1 단기 계획
- [ ] iOS 지원
- [ ] 릴리스 빌드 최적화
- [ ] 에러 처리 개선

### 14.2 중기 계획
- [ ] 통계 및 분석 기능
- [ ] 다국어 지원
- [ ] 다크 모드 지원

### 14.3 장기 계획
- [ ] 웹 버전 지원
- [ ] 그룹 기능
- [ ] 커스텀 알림 시간 설정

---

## 15. 기술적 제약사항

### 15.1 현재 제약사항
- iOS 미지원 (Android만 지원)
- 미회신 자동 체크 기능 없음 (보호자가 직접 확인)
- 하루 1회만 응답 가능

### 15.2 알려진 이슈
- Firebase Functions Node.js 20 런타임이 2026년 10월 31일에 종료 예정 (업그레이드 필요)
- `firebase-functions` SDK 버전 업데이트 권장 (현재 4.9.0 → 5.1.0 이상)

---

## 16. 참고 문서

- [프로젝트 구현 현황 최신](./프로젝트-구현-현황-최신.md)
- [Firebase 배포 가이드](./Firebase-배포-가이드.md)
- [Cloud Functions 배포 가이드](./Cloud-Functions-배포-가이드.md)
- [비용 예상 (1만명)](./비용-예상-1만명.md)

---

**문서 작성자**: AI Assistant  
**최종 수정일**: 2026년 2월 6일 (GPT 검증 반영)  
**버전**: 2.1

---

## 17. 보호대상자 중심 인식 전환 가이드라인

### 17.1 핵심 원칙
- **보호자를 위한 안부 확인 앱** → **독거노인이 부담 없이 쓰는 안부 기록 앱**
- 보고·의무·감시 뉘앙스 제거
- 본인을 위한 기록 행위로 인식 전환

### 17.2 사용 금지 표현
- "알려주기", "보고하기" 등 보고 뉘앙스 표현
- "고마워요" 등 종결·안심을 암시하는 표현
- "여기까지", "충분", "안부 종료" 등 종결 표현
- 걱정 유발, 감정 호소, 보호자 중심 메시지
- 판단·평가 표현 (이력 화면 요약 문장)

### 17.3 권장 표현
- "기록하기", "남기기" 등 기록 행위 표현
- "오늘 상태를 남겼어요.", "기록되었습니다." 등 단순 완료 메시지
- "컨디션", "상태" 등 중립적 표현
- 과장 없이 앱의 용도를 설명하는 문구

### 17.4 적용 범위
- 화면 제목 및 버튼 라벨
- 완료 메시지
- 알림 메시지
- 초대 링크 공유 메시지
- 안내 문구 및 설명 텍스트
