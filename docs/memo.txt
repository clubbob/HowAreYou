기능명

컨디션 한 줄 메모 기능 (개인 전용)

1️ 기능 목적

보호대상자가 컨디션 선택 시 한 줄 메모 입력 가능

메모는 보호자에게 전달되지 않음

메모는 본인만 최근 컨디션 화면에서 확인 가능

UI는 “신호 중심 구조”를 유지해야 함

2️ 입력 화면 변경 사항

2.1 위치

감정 선택 버튼 아래에 항상 노출

2.2 UI 구성
한 줄 메모 (선택)
[ __________________________ ]
※ 이 메모는 보호자에게 전달되지 않습니다.

2.3 동작 조건

감정 선택 시 → 입력창 자동 포커스

최대 50자 제한

입력 안 해도 저장 가능

플레이스홀더:
"필요하면 한 줄만 남겨요."

2.4 UX 제약

입력창 기본 높이 1줄

자동 줄바꿈 허용

입력창은 화면의 주인공이 되면 안 됨 (보조 UI)

3️ Firestore 데이터 구조 -> 이 부분은 GPT 의 제안일 뿐 Cursor 너가 주도적으로 해.

기존 구조 유지:

subjects/{subjectUid}/prompts/{date_slot}


필드 추가:

mood: string
memo: string | null
createdAt: timestamp


조건:

memo는 null 허용

빈 값이면 null 저장

별도 컬렉션 생성 금지

4️ 보호자 접근 제한 (중요)

보호자 화면

memo 필드 절대 노출 금지

guardian API 응답에서 memo 제외

Security Rules

guardian:

mood: read 가능

memo: read 불가

subject:

mood: read/write

memo: read/write

5️ 최근 컨디션 페이지 수정 사항

핵심 원칙

현재 페이지는:

오늘 상태 카드

최근 7일 그래프

더 보기(최근 30일)

이 구조를 깨지 말 것.

5.1 오늘 상태 카드

❌ 메모 표시하지 않음
(오늘 카드에는 감정 신호만 표시)

5.2 최근 7일 그래프

그래프 구조 변경 없음.

5.3 메모 표시 방식 (그래프 아래)

그래프 아래에 새로운 섹션 추가:

제목 (작게, 보조 느낌)
최근 7일 메모

표시 규칙

최근 7일 데이터만 표시

memo가 null이면 해당 날짜는 표시 안 함

날짜 내림차순 정렬

UI 예시
2/13 😊 괜찮아
회의 많았지만 무난

2/12 😐 보통
조금 피곤

표시 조건

메모 최대 2줄

2줄 초과 시 … 처리

탭 시 상세 보기 (선택 사항)

6️ 저장 정책

DB 저장: 무제한

UI 표시: 최근 7일만

수정 기능 없음 (MVP)

삭제 기능 없음 (MVP)

7️ 성능 및 쿼리 조건

최근 컨디션 페이지 로드 시:

기존 7일 쿼리 그대로 사용

동일 쿼리 결과에서 memo 필드 포함

추가 쿼리 발생 금지

8️ 절대 금지 사항

메모 검색 기능 추가 금지

텍스트 분석 금지

메모 통계 금지

보호자에게 일부라도 공유 금지

푸시 알림 로직에 사용 금지

9️ 철학 제약

이 기능은:

일기 기능이 아님

감정 상담 기능이 아님

분석 시스템이 아님

목적은 단 하나:

상태는 공유
이유는 개인의 영역

최근 컨디션 페이지의 “신호 중심 구조”를 절대 해치지 말 것.