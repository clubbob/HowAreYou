# Firebase 프로덕션 모드 전화번호 인증 제한사항

## ⚠️ 중요: 제한사항이 있습니다!

프로덕션 모드에서도 **모든 전화번호**가 자동으로 로그인 가능한 것은 **아닙니다**.

## 1. SMS 지역 정책 (SMS Region Policy)

Firebase는 프로덕션 모드에서 **SMS 지역 정책**을 설정할 수 있습니다:

### Allowlist-only 정책 (화이트리스트)
- **특정 지역만 허용**: 설정한 지역의 전화번호만 인증 가능
- 예: 한국만 허용 → 한국 전화번호만 로그인 가능

### Denylist-only 정책 (블랙리스트)
- **특정 지역만 제외**: 설정한 지역을 제외한 모든 지역 허용
- 예: 스팸이 많은 지역 제외

### Google 권장사항
- **Google은 명시적으로 SMS 지역 정책을 설정하는 것을 강력히 권장합니다**
- 운영 지역에 맞춰 정책을 설정해야 스팸/남용을 방지할 수 있습니다

## 2. 일일/시간당 발송 제한

### 일일 제한
- **3,000건/일** (Blaze 플랜 기준)
- 무료 플랜에서는 더 제한적일 수 있음

### 시간당 제한
- **IP당 150건/시간**
- 같은 IP에서 너무 많은 요청 시 제한

### 분당 제한
- 전체: **1,000건/분**
- IP당: **50건/분**

## 3. 지원 국가 및 전달 신뢰도

### 지원 국가
- Firebase는 전 세계 대부분의 국가를 지원합니다
- 하지만 SMS 전달 신뢰도는 지역마다 다릅니다

### 신뢰도가 높은 지역
- 북미, 유럽 대부분의 국가
- 아시아: 한국, 일본, 중국 등
- 아프리카, 남미 일부 국가

### 신뢰도가 낮은 지역
- 일부 개발도상국
- 통신 인프라가 약한 지역

## 4. 실제 동작 방식

### 프로덕션 모드에서:
1. **SMS 지역 정책이 설정되어 있으면**: 해당 지역의 전화번호만 인증 가능
2. **SMS 지역 정책이 없으면**: 지원되는 모든 지역의 전화번호 인증 가능
3. **하지만**: 일일/시간당 제한에 걸리면 인증 실패

### 예시 시나리오

#### 시나리오 1: 한국만 허용 설정
- SMS 지역 정책: 한국만 Allowlist
- 결과: 한국 전화번호만 로그인 가능
- 다른 국가 번호: 인증 실패

#### 시나리오 2: 정책 없음
- SMS 지역 정책: 설정 안 함
- 결과: 지원되는 모든 국가의 전화번호 인증 가능
- 하지만: 일일 3,000건 제한에 걸릴 수 있음

#### 시나리오 3: 일일 제한 초과
- 하루 3,000건 인증 완료
- 3,001번째 요청: 인증 실패 (제한 초과)

## 5. 권장 설정

### 한국 서비스인 경우:
1. **SMS 지역 정책 설정**: 한국만 Allowlist
2. **이유**:
   - 스팸/남용 방지
   - 비용 절감 (불필요한 해외 인증 방지)
   - 보안 강화

### 글로벌 서비스인 경우:
1. **SMS 지역 정책 설정**: 운영 지역만 Allowlist
2. **또는**: 스팸이 많은 지역만 Denylist
3. **모니터링**: 일일 사용량 추적

## 6. 결론

### ❌ 잘못된 이해:
- "프로덕션 모드에서는 모든 전화번호가 자동으로 로그인 가능"

### ✅ 올바른 이해:
- 프로덕션 모드에서도 **SMS 지역 정책**에 따라 제한됨
- **일일/시간당 발송 제한**이 있음
- Firebase Console에서 **명시적으로 정책을 설정**해야 함
- Google은 **지역 정책 설정을 강력히 권장**

## 7. 설정 방법

### Firebase Console에서:
1. **Authentication** → **Settings** → **SMS region policy**
2. **Allowlist** 또는 **Denylist** 선택
3. 허용/제외할 국가 선택
4. 저장

### 참고 링크:
- [SMS Regions Documentation](https://docs.cloud.google.com/identity-platform/docs/admin/sms-regions)
- [Firebase Authentication Limits](https://firebase.google.com/docs/auth/limits)
