# 스토어 등록용 서명/키 준비

> Play Store / App Store 업로드 전 필수 설정

---

## 1. Android (Google Play) — Release 서명

### 1.1 Upload Keystore 생성

**위치**: `android/upload-keystore.jks`

프로젝트 루트에서 실행:

```bash
cd android
keytool -genkey -v -keystore upload-keystore.jks -keyalg RSA -keysize 2048 -validity 10000 -alias upload
```

- **alias**: `upload` (고정)
- **비밀번호**: storePassword, keyPassword 각각 설정 (동일하게 해도 됨)
- **입력 정보**: 이름, 조직 등 안내에 따라 입력

### 1.2 key.properties 생성

```bash
cd android
cp key.properties.example key.properties
```

`key.properties`를 열어 **실제 비밀번호**로 수정:

```properties
storePassword=실제_스토어_비밀번호
keyPassword=실제_키_비밀번호
keyAlias=upload
storeFile=../upload-keystore.jks
```

- `storeFile`은 `android/app/` 기준 상대경로 (기본값: `../upload-keystore.jks` = android/upload-keystore.jks)

### 1.3 signingConfig 연결

`android/app/build.gradle.kts`에서 이미 적용됨:

- `key.properties` 존재 시 → release 서명에 사용
- 없으면 → debug 키로 서명 (스토어 업로드 불가)

### 1.4 Git 제외 (필수)

`.gitignore`에 이미 추가됨:

```
android/upload-keystore.jks
android/key.properties
```

**확인**: `git status`에서 위 파일이 나오면 안 됨.

### 1.5 로컬 보관 (중요)

| 항목 | 보관 방법 |
|------|----------|
| `upload-keystore.jks` | 로컬 PC + USB/암호화 백업 1부 |
| `key.properties` | 로컬 PC (백업 권장) |

**절대 금지**:
- Git 커밋/푸시 (공개·비공개 모두)
- homepage `.env` / `.env.local` 등에 저장
- Vercel 등 배포 환경에 업로드
- 클라우드 저장소에 업로드

### 1.6 빌드 검증

```bash
flutter clean
flutter build appbundle --release
```

성공 시 `build/app/outputs/bundle/release/app-release.aab` 생성.

---

## 2. iOS (App Store) — 기본 준비

### 2.1 Bundle Identifier

**현재**: `com.andy.howareyou` (Android와 동일)

- `ios/Runner.xcodeproj/project.pbxproj`에 반영됨
- Apple Developer 계정에서 App ID 등록 시 동일한 값 사용

### 2.2 Xcode 서명

1. `ios/Runner.xcworkspace`를 Xcode로 열기
2. **Signing & Capabilities** → **Automatically manage signing** 체크
3. Team 선택 (Apple Developer 계정)
4. **Product** → **Archive** 실행

### 2.3 인증서/프로비저닝 보관

- Mac Keychain에 자동 저장 (파일로 repo 저장 안 함)
- 필요 시 `.p12` 내보내어 오프라인/암호화 백업 (Git 저장 금지)

---

## 3. 절대 금지 사항

| 금지 | 설명 |
|------|------|
| `homepage/.env.local` 등에 keystore/비번 저장 | env는 배포 시 노출될 수 있음 |
| Git 커밋/푸시 | keystore, key.properties, .p12 |
| Vercel 등 배포 환경 업로드 | 환경 변수에 비밀 키 넣지 말 것 |

---

## 4. 파일 위치 요약

| 파일 | 위치 | Git |
|------|------|-----|
| `upload-keystore.jks` | `android/` | 제외 |
| `key.properties` | `android/` | 제외 |
| `key.properties.example` | `android/` | 포함 (템플릿) |
